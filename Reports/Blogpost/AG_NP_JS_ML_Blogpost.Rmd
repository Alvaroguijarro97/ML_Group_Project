---
title: "Cross-country abortion travelers in Germany: What “Foreigners” in German abortion statistics can tell us"
description: |
  We present a classifier approach in order to estimate the origin of abortion seekers within the different states of Germany.
author: 
  - name: Niklas Pawelzik, Justus v. Samson-Himmelstjerna, Alvaro Guijarro May
    
date: "`r Sys.Date()`" 
creative_commons: CC BY
repository_url: https://github.com/Alvaroguijarro97/ML_Group_Project
output: 
  distill::distill_article: 
    self_contained: false
preview: distill-template/figures/BERTfig3.png
bibliography: bibliography.bib

---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)

# Load dependencies 
library(reticulate) # For rendering Python code
```

## Problem

There is a lot to be learnt from the Polish abortion laws about European morality policies, that debate policies touching on fundamental values. Despite its great overall impact on European politics, regarding morality policies, the European Union has remained mostly invisible. In an indirect fashion, however, open Schengen borders and Europeanization of related policies have eased the access for European citizens to other morality policy regimes. In turn, this means that *national capacities to effectively govern their population can be undermined by the access to more liberal regimes in fellow EU-countries*: If the Polish government further restricts access to abortion care, Polish women will seek this care in more permissive neighboring countries.

To quantify this effect, however, is a difficult task, given the absence of official statistics or border controls, and the desire of abortion-seeking women for discretion. The current project, therefore, proposes to approach in an indirect manner, based on the assumption that, *if a tighter abortion regime in country A causes women to cross borders to seek abortion care in country B, this should result in a higher number of abortions performed on foreigners in country B*. Reviewing the literature in the field, researchers of the "Europe Abortion Access Project" conclude that the purpose of seeking abortion care abroad is a "phenomenon [that] remains poorly understood" [@EAAP]. They argue that the lack of scientific insight in this aspect of European abortion regimes is linked to a general lack of sufficient "quantitative and qualitative data" on the matter.

In line with these thoughts, we present a Logistic Regression Model for Binary Classification model, Random Forrest Classifier, and a Support Vector Machine Model that predicts labels for abortions regarding whether they were performed on foreigners or members of the national population. The labeling is based on state-level information about abortion policies in neighboring countries, population share with a migrant background, and foreign population in the respective state. Given the feasibility limits in terms of time and data access, this project developed an initial framework based on German data on abortion statistics of the year 2021. The paper concludes with several promising avenues how to expand this approach in future research.

## Data

1. **Abortions by foreign and local populations in the Germany.**

The Federal Statistical Office of Germany published a data set containing information on abortions performed annually at the federal level. This data is subdivided into each respective annual quarter. Furthermore, information on the origin of the patient is listed for the individual procedures, whereby a distinction is made between the various federal states and the category "foreigners". The dataset contains information for all 16 federal states with an annual number of about 100,000 abortions performed in Germany from 1996 up to 2021. We have wrangeld that data in such a way, that we are able to access for each federal state within Germany the fraction of foreign abortions in comparison to the abortions performed overall within Germany [^1].

2. **Abortion Index Score of European Countries.**

This Index is an initiative by the European Parliamentary Forum for Sexual and Reproductive Rights (EPF) and International Planned Parenthood Federation European Network (IPPF EN). It is an in-depth analysis of abortion policies for the Year 20221 across Europe, which scores 53 European countries and territories in accordance with their respective legal frameworks in reference to their access to safe abortion care.
The questions and structures for the Atlas were designed by a group of experts in sexual and reproductive health and rights. They came up with an overall score on a scale from 0-100 composed of four sections with several sub-categories: "access", "legal status of abortion care”, "clinical care and service delivery", and "information and online information". Since this data set is only published as a PDF-Document, so we needed to extract the data points. Next, we filtered the data for rows and columns that held significance in the given context and created a dataframe that could be compared to our other data [^2].

3. **Foreign Population Distribution of German States.**

The statistics on foreigners registered in Germany done by the Federal Statistical Office contain different representations of the regional distribution of the foreign population. Among other things, they list the federal states, sex, years of age and country groupings/citizenship. With the help of this dataset, we hope to identify driving factors for higher shares of abortions performed on foreigners, checking for variables such as the composition of foreign populations in comparison to the proximity to neighbouring countries with stricter abortion policies [^3].

4. **German Population with migrant background in the German States.**

The Federal Office for Migration and Refugees conceived in 2020 a census on a representation basis (Mikrozensus) to approximately identify the different migrant groups German citizens have as background, derived from the country of origin of their respondents or parents.  For each of the federal states in Germany, this dataset contains the number of citizens that have a migrant background from one of the EU 27 countries, and only the most significant groups were kept for further research since some migrant population groups were so small that their share in the overall population of the state was negligible [^4].

5. **Geographical distance of German States to European Countries.**

In order to calculate the distances between the 16 German States and the different countries in the European continent, we created a dataset with the information needed. This was done by collecting data on City Name, Longitude, Latitude, Country, State, Region, City Status, Population Density, Population, and Id of more than 4 million unique cities around de world. With this dataset, we calculated the average distance between the German State's Capitals and all of the cities available in the dataset from each one of the European countries, to sequential determine the respective distance between them [^5].

[^1]: https://www-genesis.destatis.de/genesis//online?operation=table&code=23311-0006&bypass=true&levelindex=1&levelid=1664961110565#abreadcrumb
[^2]: https://www.epfweb.org/node/857
[^3]: https://www-genesis.destatis.de/genesis/online#astructure
[^4]: https://www.bamf.de/DE/Themen/Forschung/Veroeffentlichungen/Migrationsbericht2020/PersonenMigrationshintergrund/personenmigrationshintergrund-node.html
[^5]: https://simplemaps.com/data/world-cities

## Proposed Method
 
The data available to us contains information on abortions per year per state. It distinguishes 'foreign' abortion-seekers ( without further information on the distribution of countries of origin), which enables us to create a binary classification model between 'foreign' and 'local'. Independent variables can be used to enable a Logistic Regression Model (LRM) and a Random Forrest Classifier (RFC) to estimate the probability that an event belongs to a specific class. In LRM, a statistical approach is used for classification problems and is used when the dependent variable (target) is categorical.  The probability of an event being of the intended class (binomial in this case) is calculated by the fitted model, trained with a portion of the available data, and if the probability is under or over a set threshold, the model will assign the corresponding class. On the other hand, the RFC will generate the most frequent answer to several  decision trees built with a random subset of features in order to select  the predicted class.

The binary dependent variable we are trying to predict is the type of abortion seeker (foreigner / German citizen). In order to predict this dependent variable, we first used a Linear Regression Model with our three independent variables. The first group of variables involves the fraction of population of every German State with a migrant background. The second group of variables involves the fraction of foreign population residing in each German State. The third group of variables involve the average distance between the German states' capital cities and the primary cities of each European country. For all three variables we then created interaction terms between the respective variable and the countries' abortion scores from the abortion atlas.

Furthermore we implemented from the scikit-Learn library the internal "class\_weight" function in all of the evaluated models and used the train-test-split function so that we could fit and evaluate the model on separate chunks of the dataset. This way, the training models can penalize the misclassification made towards the minority class (foreign patient) by setting a higher class weight and simultaneously reduce the weight for the majority class (domestic patient).

After experiencing some issues with parameter and hyperparameter tuning for our Logistic Regression we decided to focus on the Random Forest Classifier in order to further understand exactly what is being predicted. From sklearn.metrics we used accuracy\_score, confusion\_matrix, roc\_auc\_score, and classification\_report. Since our first unweighted Random Forest Model was only predicting class 0, and hence forth completely ignoring the minority class in favor of the majority class, we decided to introduce a class wight to our model. We then further improved our AUROC value by using a Balanced Random Forest Model with random undersampling.

Lastly, in order to better compare our results from Logistic Regression Model and the Random Forest Classifier, we decided to run a Support Vector Machine algorithm as well. We reported the performance of this model by calculating the mean area under the ROC curve, by gathering three repeats of 10-fold cross-validations.

## Results

As expected, our unweighted models would not be able to predict the minority class, since we knew that our data was heavily skewed and therefore, unbalanced. At a first glance, however, all weighted and balanced models yielded better results than we expected since the accuracy score for all of our weighted models were in the high 80s, which were promising high explanatory values. However since accuracy is not a great measure of classifier performance when the classes are imbalanced, we also generated the Area under the Receiver Operating Characteristic (ROC) Curve, measuring the overall summary of diagnostic accuracy. Since the AUC equals 0.5 when the ROC curve corresponds to random chance and 1.0 for perfect accuracy, we were quite content at first with our results in the high 80s and low 90s. However, as soon as we look at our F1 Scores, as well as the feature importance of our Model, we realised that these values did measure the performance of our Models accurately.

```{r fig3, eval = TRUE, echo = FALSE, out.width = '100%', fig.cap = "Results of Evaluated Models"}
knitr::include_graphics("graphics/Models_Results.png")
```
```{r fig4, eval = TRUE, echo = FALSE, out.width = '60%', fig.cap = "Confusion Matrix of Random Forrest Classifier (weighted)"}
knitr::include_graphics("graphics/CM_Random_Forest_Classifier_(weighted).png")
```

All of the confusion matrixes look like the weighted Random Forrest Classifier model. Models that include computanionally generated weights assign both labels, and with more than 40.000 abortions correctly predicted as performed on Germans, more than 80\% of the labels per class were attached correctly. Thanks to the weights attached to the classes, in a similar manner more than 80\% of the almost 300 abortions performed on foreigners were correctly predicted. Given that all of our variable opreate exclusively on the state-level, we consider this explanatory capacity of 80\% per class of our models a great success, especially compared to their unweighted counter parts.

The poor performance of our model on these metrics shows that the low number of German states involved in combination with abortion indices for only a single year lays too heavily on the explanatory power of our models. We anticipated that this problem, which is inherent in our available data, might constitute a challenge for our project. Our models provide a satisfying answer to the class imbalance; however, the problems in the data structure itself could neither be avoided nor solved by the current means at our hand. Given that we have had only state-level data from the 16 German states available, and that we could therefore only combine a total of 32 value combinations.

We, therefore, consider the current state of our project a partial success nevertheless, given that we detected the hidden performance issues, and were able to identify and explain the issue as outlined in the analysis below. This in turn allowed us to identify clear strategies for solutions and further expansions in more resourceful project settings in the conclusive remarks of our project paper.

## Analysis

The particularities of our data discussed in earlier chapters are reflected in the results our models produce. Given the extreme imbalance of our data, unbalanced models behave essentially like dummy models: Aiming for high accuracy scores, they label every abortion as domestic without exception. This results in accuracy scores that are logically equal to the class distribution: less than 1\% of our data represents abortions performed on foreigners, thus labeling every abortion as domestic is a successful strategy in more than 99\% of the cases. In order to produce meaningful results, however, we have to focus on foreign abortions: Mislabeled German (domestically performed) abortions are less problematic than mislabeled foreign abortions. Our balanced models have more explanatory power because they can provide precisely this added value in comparison to the unbalanced classifiers. Following this focus on labeling foreign abortions, our preliminary factor analysis becomes relevant: While keeping the flaws of our models in mind, the most important factors among the interaction terms are pointing in a clear direction: 13 of the 15 most important independent variables are distance-based, if one considers predictive power for abortions on foreigners. Even though these insights must be taken with caution, they are in line with the initial intuition: Proximity to neighbouring countries in combination with the level of restrictiveness within these countries´ abortion regimes is a strong predictor for a high number of foreign abortions.

Going back to the paper´s starting assumption, this comes as no surprise: Berlin and Brandenburg, the closest states to Poland (a country with highly restrictive policies), have the highest number of foreign abortion seekers within Germany. States with big communities of Polish foreigners or Germans with Polish migrant backgrounds, however, such as North Rhine Westphalia, do not show higher numbers for abortions performed on foreigners, both in absolute and relative numbers. These two independent variables, people with migrant backgrounds and foreigners, seem to play only a minor role in explaining the cases of abortions performed on foreigners. While the data included needs to be expanded and diversified, there is a clear trend regarding what matters when it comes to explaining abortions performed on foreigners: proximity to neighbouring countries and the degree of restrictiveness of their respective abortion regimes.

## Conclusion

The project aimed to provide a classifier model that predicts labels for abortions in a binary fashion, as either being performed on German or non-German women. 
With models that include computationally generated weights, more than 80\% of the labels per class were attached correctly. Given the exclusively state-level nature of our data, this explanatory capacity is a remarkable success. Preliminary factor importance analysis furthermore suggests that of the three considered explanatory variables, geographical proximity combined with abortion restrictiveness scores is the decisive factor for these predictions, and migrant background share and foreign population are of little relevance.     
The poor performance indicated for instance by the F1 scores results from the flaws of our data structure. Variables that exclusively operate on a state level capture only 32 value combinations constitut a clear limitation to the models´ success. 
However, this clear identification of the source of problems - the low number of distinct value combinations - allows for three concrete suggestions for refined future research projects:
A first option would be to include data that operate on a lower level, ideally on the level of the individual abortion. The binary classifier logic we developed for this project would allow an easy incorporation of such information since the dataframe already lists one observation per abortion. However, such individual data on abortions is not publicly available, the only way to gain access to this type of information would therefore be through non-public channels.

A second option would be to include updated data on abortion numbers and abortion scores in upcoming years. Including abortion numbers from past years currently already available would not be sufficient for this: In order to generate new value combinations, the independent variables would need to change. Unfortunately, only the abortion numbers - so the binary dependent variable - are updated on an annual basis. Only subsequent editions of the first abortion atlas could provide new value combinations for our current independent variables populated by the German state.

The third and most promising approach would therefore be to expand the developed approach beyond the German states and include data from further European countries. Including state-level data from further countries would multiply the amount of value combination for each independent variable and improve our model drastically. Unfortunately, accessing and processing the required census and abortion data from additional European countries would certainly not have been feasible within this project, given the nationally specific data structure and the extremely time-consuming wrangling process. However, the first promising results of the present project might justify a subsequent project in order to further pursue the developed pioneering approach to quantify abortion migration across European borders by using classifier models.
